# Google Business Bot

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞ —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ Google Drive.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ VPS-—Å–µ—Ä–≤–µ—Ä

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Git

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
   ```
   git clone https://github.com/evseew/GoogleBusinessBot.git
   cd GoogleBusinessBot
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
   ```
   chmod +x server_setup.sh
   ./server_setup.sh
   ```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env:
   ```
   nano .env
   ```
   –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:
   ```
   TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
   OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_openai
   ASSISTANT_ID=–≤–∞—à_id_–ø–æ–º–æ—â–Ω–∏–∫–∞
   GOOGLE_DRIVE_FOLDER_ID=id_–ø–∞–ø–∫–∏_–≥—É–≥–ª_–¥—Ä–∞–π–≤
   ```

4. –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª `service-account-key.json` –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∫–∞–∫ systemd-—Å–µ—Ä–≤–∏—Å:
   ```
   sudo systemctl start google-business-bot
   sudo systemctl status google-business-bot
   ```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ä—É—á–Ω—É—é

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã:
   ```
   mkdir -p ~/GoogleBusinessBot/logs/context_logs
   cd ~/GoogleBusinessBot
   # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```
   python3 -m venv new_venv
   source new_venv/bin/activate
   pip install -r requirements.txt
   ```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env –∏ –¥–æ–±–∞–≤—å—Ç–µ service-account-key.json

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å –∏ cron:
   ```
   sudo cp google-business-bot.service /etc/systemd/system/
   sudo systemctl daemon-reload
   sudo systemctl enable google-business-bot
   (crontab -l 2>/dev/null; cat crontab_entry.txt) | crontab -
   ```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

- **–ó–∞–ø—É—Å–∫**: `sudo systemctl start google-business-bot` –∏–ª–∏ `./start_bot.sh`
- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞**: `sudo systemctl stop google-business-bot` –∏–ª–∏ `./stop_bot.sh`
- **–°—Ç–∞—Ç—É—Å**: `sudo systemctl status google-business-bot` –∏–ª–∏ `./control.sh status`
- **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫**: `sudo systemctl restart google-business-bot` –∏–ª–∏ `./restart.sh`
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã**: `./update_db.sh`
- **–õ–æ–≥–∏ —Å–ª—É–∂–±—ã**: `journalctl -u google-business-bot -f`
- **–õ–æ–≥–∏ –±–æ—Ç–∞**: `tail -f logs/bot.log`

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ 1–°

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ 1–° —á–µ—Ä–µ–∑ Bitrix:

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```bash
./check_sync.sh
```

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- **–ö–∞–∂–¥—ã–π —á–∞—Å** (00:00) ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`transactions.json`)
- **–ö–∞–∂–¥—ã–π –¥–µ–Ω—å** (06:00) ‚Äî –∫–ª–∏–µ–Ω—Ç—ã –∏ –¥–æ–≥–æ–≤–æ—Ä—ã (`clients.json`, `contracts.json`)

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```bash
# –¢–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
./scripts/sync_1c_hourly.sh

# –ö–ª–∏–µ–Ω—Ç—ã –∏ –¥–æ–≥–æ–≤–æ—Ä—ã
./scripts/sync_1c_daily.sh
```

### –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ü–æ—á–∞—Å–æ–≤–∞—è: `logs/sync/hourly.log`
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è: `logs/sync/daily.log`

**üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [`docs/SYNC_1C_SETUP.md`](docs/SYNC_1C_SETUP.md)

**‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è macOS:** Cron —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è Full Disk Access –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö!

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start` –±–æ—Ç—É –≤ Telegram
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫: `tail -f logs/bot.log`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã: `sudo systemctl status google-business-bot`

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

- **–ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**:
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `journalctl -u google-business-bot -e`
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ API
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `chmod +x *.sh`

- **–ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö**:
  - –û–±–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –≤—Ä—É—á–Ω—É—é: `./update_db.sh`
  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: `cat logs/db_update.log`

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ Git**:
  ```
  git pull
  sudo systemctl restart google-business-bot
  ```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –Ω–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥ –∏ –æ–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
- `/clear` - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞
- `/update` - –æ–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –≤—Ä—É—á–Ω—É—é
- `/check_db` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–õ–æ–≥–∏ –±–æ—Ç–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `logs`:
- –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥: `logs/bot.log`
- –õ–æ–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã: `logs/db_update.log`

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- aiogram 3.x
- openai
- python-dotenv

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram Business

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–æ—Ç–∞ –∫ –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç—É Telegram:

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç –≤ Telegram**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram
   - –í—ã–±–µ—Ä–∏—Ç–µ "Telegram Premium" > "Telegram Business"
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ñ–∏–ª—è

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞**:
   - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–∏–∑–Ω–µ—Å-–∞–∫–∫–∞—É–Ω—Ç–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "–ß–∞—Ç-–±–æ—Ç"
   - –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å –±–æ—Ç–∞" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Telegram**:
-  - –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–æ—Ç–∞ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏–∏
-  - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É `/business_hours` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
-  - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É `/business_greeting –¢–µ–∫—Å—Ç` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
+  - –í—Å–µ –±–∏–∑–Ω–µ—Å-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—á–∞—Å—ã —Ä–∞–±–æ—Ç—ã, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –æ—Ç–≤–µ—Ç—ã) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 
+    –º–µ–Ω—é Telegram Business –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
+  - –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∏–∑–Ω–µ—Å-—Ä–µ–∂–∏–º –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- ## –ë–∏–∑–Ω–µ—Å-–∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- 
- - `/business_hours` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã (–ü–Ω-–ü—Ç, 9:00-18:00)
- - `/business_greeting –¢–µ–∫—Å—Ç` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤