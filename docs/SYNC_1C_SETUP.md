# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å 1–°

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ 1–° —á–µ—Ä–µ–∑ Bitrix –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:
- **–ü–æ—á–∞—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`transactions.json`)
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –∫–ª–∏–µ–Ω—Ç—ã –∏ –¥–æ–≥–æ–≤–æ—Ä—ã (`clients.json`, `contracts.json`)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron

### –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏

```cron
# –ü–æ—á–∞—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–∫–∞–∂–¥—ã–π —á–∞—Å –≤ 0 –º–∏–Ω—É—Ç)
0 * * * * /Users/test/Local_code/GoogleBusinessBot/scripts/sync_1c_hourly.sh >> /Users/test/Local_code/GoogleBusinessBot/logs/sync/hourly.log 2>&1

# –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00)
0 6 * * * /Users/test/Local_code/GoogleBusinessBot/scripts/sync_1c_daily.sh >> /Users/test/Local_code/GoogleBusinessBot/logs/sync/daily.log 2>&1
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞—á

```bash
crontab -l
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á

```bash
crontab -e
```

### –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á

```bash
crontab -r
```

## üîß –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è macOS

### 1. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è cron

–ù–∞ macOS Catalina –∏ –Ω–æ–≤–µ–µ cron —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è **Full Disk Access**.

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å **–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
2. –í—ã–±—Ä–∞—Ç—å **Full Disk Access** (–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∏—Å–∫—É)
3. –î–æ–±–∞–≤–∏—Ç—å `/usr/sbin/cron`
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å cron:
   ```bash
   sudo launchctl stop com.vix.cron
   sudo launchctl start com.vix.cron
   ```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã cron

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω –ª–∏ cron
ps aux | grep cron

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ cron
log show --predicate 'process == "cron"' --last 1h
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –õ–æ–≥–∏

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/sync/`:
- `hourly.log` ‚Äî –ø–æ—á–∞—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- `daily.log` ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ø–æ—á–∞—Å–æ–≤—ã—Ö –ª–æ–≥–æ–≤
tail -50 logs/sync/hourly.log

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –ª–æ–≥–æ–≤
tail -50 logs/sync/daily.log

# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/sync/hourly.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤
ls -lh data/*.json

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å XML —Ñ–∞–π–ª—ã
ls -lh data/xml/*.xml
```

## üß™ –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ü–æ—á–∞—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ transactions)

```bash
./scripts/sync_1c_hourly.sh
```

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (clients + contracts)

```bash
./scripts/sync_1c_daily.sh
```

### –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤

```bash
cd /Users/test/Local_code/GoogleBusinessBot
source new_venv/bin/activate
python -m tools.bitrix_sync
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
   ```bash
   ls -la scripts/*.sh
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rwxr-xr-x
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å crontab:**
   ```bash
   crontab -l
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```bash
   tail -100 logs/sync/hourly.log
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:**
   ```bash
   ./scripts/sync_1c_hourly.sh
   ```

### –û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö:
- `scripts/sync_1c_hourly.sh` (—Å—Ç—Ä–æ–∫–∏ 36-38)
- `scripts/sync_1c_daily.sh` (—Å—Ç—Ä–æ–∫–∏ 36-38)

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ macOS

–ï—Å–ª–∏ cron –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º:
1. –î–æ–±–∞–≤–∏—Ç—å `/usr/sbin/cron` –≤ Full Disk Access
2. –î–æ–±–∞–≤–∏—Ç—å Terminal.app –≤ Full Disk Access
3. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö

- `clients.json` ‚Äî ~2.0 MB
- `contracts.json` ‚Äî ~551 KB
- `transactions.json` ‚Äî ~12 MB (45696+ –∑–∞–ø–∏—Å–µ–π)

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- –ü–æ—á–∞—Å–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: ~2-3 —Å–µ–∫—É–Ω–¥—ã
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: ~5-10 —Å–µ–∫—É–Ω–¥

## üöÄ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª—ã | –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è |
|--------|------------|-------|-----------------|
| –ü–æ—á–∞—Å–æ–≤–∞—è | –ö–∞–∂–¥—ã–π —á–∞—Å (00:00) | `transactions.xml` | ~2-3 —Å–µ–∫ |
| –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è | –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00 | `clients.xml`, `contracts.xml` | ~5-10 —Å–µ–∫ |

---

**–î–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** 23 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ

